---
authors: forliy
title: 2022å¹´ç¬¬16å‘¨å‘¨æŠ¥
tags: [2022å‘¨æŠ¥,å‘¨æŠ¥]
---

2022å¹´ç¬¬16å‘¨å‘¨æŠ¥å–µã€‚

<!--truncate-->

## ğŸš€ ç‰ˆæœ¬å‘å¸ƒ
åœ¨ç¬¬16å‘¨å†…ï¼Œæˆ‘ä»¬å‘å¸ƒäº†å¦‚ä¸‹çš„ç‰ˆæœ¬ï¼š
- **å¼€é»‘å•¦ç»„ä»¶** [v3.0.0.0.preview.1.2](https://github.com/simple-robot/simbot-component-kaiheila/releases/tag/v3.0.0.0.preview.1.2)


å¹¶è®¡åˆ’åœ¨æœ¬å‘¨èŒƒå›´å†…å†å‘å¸ƒä¸€ä¸ªä¸ [Simple Robotæ ¸å¿ƒ](https://github.com/simple-robot/simpler-robot) 
ç›¸å…³çš„æ–°ç‰ˆæœ¬ `v3.0.0.preview.8.0`, æ­¤ç‰ˆæœ¬é¢„è®¡çš„æ›´æ–°å†…å®¹æœ‰ï¼š
- è°ƒæ•´éƒ¨åˆ† `BotManager` ç›¸å…³çš„API
- é‡å†™ä¼˜åŒ– `BotVerifyInfo` çš„å®ç°ï¼Œå¹¶ä¸ºæœªæ¥æ”¯æŒå¤šç§é…ç½®æ–‡ä»¶æ ¼å¼åšåŸºç¡€
- é‡æ–°å®šä¹‰éƒ¨åˆ†äº‹ä»¶ï¼ˆä¸»è¦æ˜¯å»é™¤å¤šä½™æ³›å‹ï¼‰

ç”±äºæ¶‰åŠåˆ°apiå˜åŠ¨ï¼Œä¼šå­˜åœ¨ä¸å…¼å®¹å˜æ›´ï¼Œè¿˜è¯·æ³¨æ„å–”ï½ æ­¤ç‰ˆæœ¬å‘å¸ƒçš„æ—¶å€™å„ç»„ä»¶ä¹Ÿä¼šè·Ÿéšæ›´æ–°ã€‚


## ğŸ‘» å¥‡å¥‡æ€ªæ€ª
ä¸€äº›ä¸Šå‘¨å‘¨æŠ¥æåˆ°çš„ç¥ç§˜çš„ä¸œè¥¿æ­£åœ¨æ…¢æ¡æ–¯ç†çš„è¿›è¡Œè®¾è®¡ä¸å¼€å‘ã€‚ä¸è¿‡å®ƒæ˜¯å¦å…¬å¼€ã€æ˜¯å¦å¼€æºå’Œå¼€æºå½¢å¼è¿˜ä¼šå¾…è®®ã€‚
> <small><i>ä¹Ÿè®¸è¿™ä¼šæˆä¸ºæ³•æ¬§è‰çš„å°ç§˜å¯†è¢«æ·±æ·±çš„è—èµ·æ¥å‘¢ï¼Ÿ</i></small>



## ğŸ— é‡æ„
ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½å·²ç»å‘ç°äº†ï¼Œæœ€è¿‘æœ‰å…³äº [åœ¨ v3.0.0.preview.10.x æ—¶è¿›è¡Œé‡æ„](https://github.com/simple-robot/simpler-robot/issues/246)
çš„ä»»åŠ¡æä¸Šäº†æ—¥ç¨‹ã€‚

æœ‰å…³è¿™æ¬¡çš„é‡æ„å†…å®¹ï¼Œissueçš„æè¿°æ˜¯ï¼š
> é‡æ„apiä¸æ ¸å¿ƒæ¨¡å—ä¸‹çš„ä½¿ç”¨æ–¹å¼ï¼Œç®€åŒ–å¹¶æä¾›æ›´åŠ ä¸€ç›®äº†ç„¶çš„apiï¼›<br />
> å°è¯•æä¾›æ›´æ˜ç¡®çš„åº”ç”¨å…¥å£ï¼Œå°è¯•æ”¶æ‹¾è¿‡åº¦è®¾è®¡çš„é—ç•™é—®é¢˜ï¼›

ä¹Ÿè®¸ä½ å¯èƒ½çœ‹ä¸å¤ªæ‡‚ä»€ä¹ˆæ„æ€ï¼Œä½†æ˜¯æ²¡å…³ç³»ï¼Œè®©æˆ‘æ¥å°è¯•ç€ç®€å•çš„è§£é‡Šè§£é‡Šã€‚

å®é™…ä¸Šv3 ç‰ˆæœ¬é¢„è§ˆç›´è‡³ç›®å‰å·²ç»æš´éœ²å‡ºäº†å¾ˆå¤šé—®é¢˜ï¼Œå…¶ä¸­å°±åŒ…æ‹¬å½“åˆä¸€äº›è¿‡åº¦è®¾è®¡æ‰€å¯¼è‡´çš„é—®é¢˜ï¼Œæ¯”å¦‚ä¸€äº›å‡ ä¹ä¸å¯èƒ½ç”¨åˆ°çš„apiæˆ–è€…ä½¿ç”¨/å®ç°ä¸Šå­˜åœ¨æ˜æ˜¾ç¼ºé™·çš„å†…å®¹ã€‚
å½“ç„¶äº†ï¼Œè™½ç„¶è¯´ä¹Ÿä¸èƒ½ä¿è¯è¿™ä¸€æ¬¡çš„é‡æ„èƒ½å¤Ÿå®Œç¾çš„è§£å†³é—®é¢˜ï¼Œä¸è¿‡... å¤šå°‘èµ·ç‚¹å„¿ä½œç”¨å§!

ç›®å‰æ˜¯ `preview` é˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µé¢‘ç¹é‡æ„ä¸æ˜¯å¾ˆæ­£å¸¸çš„äº‹æƒ…å˜›ï¼ï¼ˆæš´è®ºï¼‰<br /> 
æ€»è€Œè¨€ä¹‹ï¼Œè¿™æ€»æ¯”åˆ°äº† `beta` ç”šè‡³ `release` é˜¶æ®µå†å»æ”¹è¦å¥½å¤šäº†å§ã€‚

é¦–å…ˆï¼Œè¿™æ¬¡çš„é‡æ„ä»»åŠ¡**ä¸»è¦**æ˜¯é’ˆå¯¹apiä¸æ ¸å¿ƒæ¨¡å—çš„ã€‚ä¸è¿‡è¿™ä¹Ÿè‚¯å®šä¼šå½±å“åˆ°ç»„ä»¶å®ç°ï¼Œæ¯”å¦‚éœ€è¦é’ˆå¯¹æ–°çš„å®šä¹‰è¿›è¡Œé‡æ–°å®ç°ç­‰ã€‚
å¹¶ä¸”ï¼Œapiä¸æ ¸å¿ƒçš„é‡æ„å¿…ç„¶å¯¼è‡´bootæ¨¡å—ä¸‹å†…éƒ¨çš„ç»“æ„å˜åŒ–ï¼Œä½†æ˜¯è¿™å¯èƒ½ä¸ä¼šè¿‡å¤šçš„å½±å“åˆ°ä½¿ç”¨ä½“æ„Ÿã€‚

ç›®å‰ç‰ˆæœ¬åœ¨æ ¸å¿ƒä¸­è¿›è¡Œä½¿ç”¨çš„æ–¹å¼å¤§æ¦‚ä¸ºå¦‚ä¸‹å½¢å¼ï¼š
```kotlin
// å…ˆå‡†å¤‡ä¸€ä¸ª eventListenerManager..
val listenerManager = coreListenerManager {
    listeners {
        // ...
    }
    
    interceptors {
        // ...
    }
    
    // å®‰è£…ä¸‹è¿°botManageræ¶‰åŠåˆ°çš„ç»„ä»¶
    install(TencentGuildComponent)
    install(KaiheilaComponent)
    
}

// å†å‡†å¤‡ä¸€äº›botManager...
val tencentGuildBotManager = tencentGuildBotManager(listenerManager) {
    // ...
} 


val kaiheilaBotmanager = kaiheilaBotManager(listenerManager) {
    // ...
}


// å†æ³¨å†Œä¸€äº›bot...
val tencentGuildBot = tencentGuildBotManager.register(clientId, token) { /* config... */ } 

val kaiheilaBot = kaiheilaBotManager.register(clientId, token) { /* config... */ }

tencentGuildBot.start()
kaiheilaBot.start()

// ...
```

å—¯...æ€ä¹ˆè¯´å‘¢, è¿™æ ·çœ‹æ¥å®ƒä»¬æ€»æ˜¯ç¼ºä¹ä¸€ç§... æ•´ä½“æ€§? ä¸»é¢˜? æ— è®ºå¦‚ä½•ï¼Œä»–ä»¬æ€»æ˜¯é›¶é›¶æ•£æ•£çš„ã€‚è™½ç„¶åœ¨é‡æ„åä¹Ÿè®¸ä¼šä¾æ—§æ”¯æŒè¿™ç§å†™æ³•ï¼Œ
ä½†æ˜¯æœ¬æ¬¡é‡æ„ä¼šä¸ºä¸Šè¿°å†…å®¹æä¾›ä¸€ä¸ªæ›´åŠ å…·æœ‰**æ•´ä½“æ€§**çš„æ„å»ºæ–¹å¼, ç±»ä¼¼äºï¼š
```kotlin
val application = simbotApplication(Simple) {
    // manager..
    listenerManager {
        listeners {
            // ...
        }
        interceptors {
            // ...
        }
    }
    
    // è…¾è®¯é¢‘é“ç»„ä»¶çš„ç»„ä»¶å¯¹è±¡å’ŒbotManager
    install(TencentGuildComponent)
    install(TencentGuildBotManager) {
        // ... config
        
        register(clientId, token) {
            // bot config...
        }
    }
    
    // å¼€é»‘å•¦ç»„ä»¶ç›¸å…³çš„ç»„ä»¶å¯¹è±¡å’ŒbotManager
    install(KaiheilaComponent)
    install(KaiheilaBotManager){
        // config...
        register(clientId, token) {
            // bot config...
        }
    }
}

// join and suspend.
application.join()
// or application.shutdown
```

åŒæ—¶ï¼Œä¹Ÿæä¾›æ›´ç®€åŒ–çš„å†™æ³•ï¼š
```kotlin
val application = simpleApplication {
        // manager ç›¸å…³çš„éƒ¨åˆ†é…ç½®...
    listeners {
        // ...
    }
    interceptors {
        // ...
    }
    
    // è…¾è®¯é¢‘é“ç»„ä»¶æä¾›çš„å®ç°
    useTencentGuild {
        // config...
        configA = ...
        
        register(clientId, token) {
            // bot config...
        }
    }
    
    // å¼€é»‘å•¦ç»„ä»¶æä¾›çš„å®ç°
    useKaiheila {
        // config...
        configB = ...
        
        register(clientId, token) {
            // bot config...   
        }
    }
} 

// join and suspend.
application.join()
// or application.shutdown
```

ä¸è¿‡ä½ å¯èƒ½ä¹Ÿå‘ç°äº†ï¼Œé‡æ„åçš„é£æ ¼æ›´å€¾å‘äºä¸€ä¸ª **Kotlin** çš„åº“è€Œå¹¶é Java å‹å¥½çš„ã€‚äº‹å®ä¸Šï¼Œç¡®å®ã€‚
æ ¸å¿ƒæ¨¡å—çš„ä½¿ç”¨å°†ä¼šæ›´åŠ å€¾å‘äºæœåŠ¡Kotlinï¼Œå› ä¸ºæ ¸å¿ƒæ¨¡å—çš„ç‰¹æ€§ï¼Œå³ä¾¿æ˜¯æ—§ç‰ˆä¹Ÿæ— æ³•å®Œå…¨ä½¿å¾—Javaç”¨æˆ·èƒ½æœ‰å¾ˆå¥½çš„ä½“éªŒã€‚

è€Œä¸”ï¼Œé€šè¿‡Javaä½¿ç”¨æ ¸å¿ƒæ¨¡å—ä¹Ÿå¾—ä¸åˆ°ä»€ä¹ˆå®è´¨æ€§çš„æå‡â€”â€”é™¤äº†"çµæ´»åº¦"ä»¥å¤–æ¯«æ— äº®ç‚¹ï¼Œè€Œè¿™ç§æ‰€è°“çš„"çµæ´»åº¦"å¯¹äºJavaè€Œè¨€æ²¡æœ‰ä»€ä¹ˆæœ¬è´¨ä¸Šçš„ä½œç”¨ã€‚

å› æ­¤ï¼Œå¯¹äºJavaç”¨æˆ·ï¼Œæ›´å»ºè®®ç›´æ¥é€šè¿‡ boot æ¨¡å—è¿›è¡Œä¸Šæ‰‹ï¼Œæˆ–è€…åƒå¤§å¤šæ•°äººä¸€æ ·ï¼Œç›´æ¥é€‰æ‹©ä½¿ç”¨ Spring Boot Starter ä½œä¸ºå¼€ç«¯ã€‚
 


## ğŸª€ å…¶ä»–å°ä»¶å„¿
è¿™æ®µæ—¶é—´é‡Œï¼Œé™¤äº†è¿›è¡Œä¸Šè¿°å†…å®¹çš„æ›´æ–°ï¼Œä¹Ÿç®€å•æ£é¼“äº†ç‚¹å„¿å…¶ä»–å°ç©æ„å„¿ï¼Œæ¯”å¦‚ææprï¼Œæˆ–è€…åšäº†ä¸€ä¸ªç®€æ˜“çš„ [ktor for nacos](https://github.com/ForteScarlet/nacos4k) æ’ä»¶åº“ã€‚å¦‚æœä½ æœ‰éœ€è¦ï¼Œå¯ä»¥ç®€å•çœ‹çœ‹ã€‚
